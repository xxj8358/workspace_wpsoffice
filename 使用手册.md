# 序时账处理工具使用手册

## 工具概述

本工具用于处理序时账数据，生成格式化的Excel报表，包含合并单元格、设置边框、替换文本等功能。

## 核心文件说明

1. **test_copy_table.py** - 主处理脚本，负责复制表格、合并单元格、设置格式等核心功能
2. **run_test_copy_table.bat** - 快速运行主脚本的批处理文件
3. **副本汉和2024序时账.xls** - 序时账数据文件（输入文件）
4. **使用手册.md** - 详细的使用说明文档
5. **安装指南.md** - Python环境和依赖库安装指南

## 如何解决 "ModuleNotFoundError: No module named 'pandas'" 错误

**重要提示**：您遇到的这个错误是因为Python环境中缺少必要的依赖库。请严格按照以下步骤操作：

1. **打开安装指南**：仔细阅读并按照"安装指南.md"中的步骤安装所有依赖库
2. **管理员权限**：务必使用管理员权限打开命令提示符
3. **使用正确的命令**：使用 `python -m pip install pandas openpyxl xlrd` 命令来安装
4. **验证安装**：安装完成后，使用验证命令确认所有库已正确安装

## 使用方法

### 处理新增数据

是的，您可以直接在序时账文件（副本汉和2024序时账.xls）中添加新的数据，然后运行处理工具即可。具体步骤：

1. 确认环境：确保所有依赖库已正确安装（参考安装指南）
2. 使用Excel打开**副本汉和2024序时账.xls**文件
3. 在文件中添加新的数据行（确保数据格式与现有数据保持一致）
4. 保存文件
5. 双击运行**run_test_copy_table.bat**文件
6. 等待处理完成，结果将保存在指定的输出文件中

### 批量添加多家数据

当您需要添加几十家的数据时，只需按照以下方式操作：

1. 在序时账文件（副本汉和2024序时账.xls）中，按照现有数据格式添加新的数据行
2. 确保每行数据都包含正确的：日期、凭证编号、科目编码、科目名称、借贷方向、金额等信息
3. 对于不同的公司或项目，可以通过科目编码进行区分
4. 程序会自动根据科目编码（如'所得税'）生成对应的工作表
5. 运行处理工具后，所有数据将被正确分类和格式化

## 注意事项

1. **数据格式一致性**
   - 新增数据必须与现有数据保持相同的格式
   - 确保日期、金额、科目编码等字段格式正确
   
2. **文件路径**
   - 不要随意更改文件的相对位置
   - 如果需要移动文件，请确保所有相关文件一起移动
   - 确保您在正确的文件路径下运行程序，所有文件应在同一目录中
   - 不要在多个不同路径下同时保留程序副本，这可能导致混淆
   
3. **运行环境**
   - 确保已安装Python 3.x
   - 必要的依赖库：pandas, openpyxl, xlrd, tkinter
   - 安装命令：pip install pandas openpyxl xlrd
   - 具体安装说明请参考**安装指南.md**
   
4. **错误处理**
   - 如果程序运行出错，请检查数据格式是否正确
   - 查看命令行输出的错误信息以获取更多详情

## 输出文件

处理完成后，结果将保存到：
`D:/old/e/双录日常问题解决方案/个人/副本汉和2024序时账_处理结果.xlsx`

您可以打开此文件查看生成的报表。

## 常见问题

**Q: 程序无法运行，显示 "ModuleNotFoundError: No module named 'pandas'"**
A: 这是最常见的问题，请严格按照"安装指南.md"中的步骤安装所有依赖库，确保使用管理员权限打开命令提示符，尝试使用国内镜像源进行安装。

**Q: 添加新数据后，程序没有处理怎么办？**
A: 请检查数据格式是否与现有数据一致，特别是科目编码、日期格式等关键字段。

**Q: 如何调整生成报表的格式？**
A: 如果需要调整报表格式，请修改test_copy_table.py文件中的相关代码，如合并单元格、设置边框等部分。

**Q: 程序运行很慢怎么办？**
A: 处理大量数据时可能会较慢，请耐心等待。如果数据量非常大，可以考虑分批处理。

**Q: 找不到Python或pip命令怎么办？**
A: 确认已正确安装Python，并已将Python添加到系统环境变量中。重新安装Python时，请务必勾选"Add Python to PATH"选项。