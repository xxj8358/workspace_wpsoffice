# WPS Office账户信息处理工具 - 安装指南

根据测试，我们发现程序无法直接运行的原因是系统中缺少必要的Python库。以下是详细的安装步骤，帮助您成功运行程序。

## 步骤一：确认Python已安装

系统中已经安装了Python 3.13.7版本，这满足程序的运行要求。

## 步骤二：安装必要的Python库

## 解决 "ModuleNotFoundError: No module named 'pandas'" 错误

您遇到的错误表明您的Python环境中缺少必要的依赖库。请按照以下步骤安装所需的所有库：

### 步骤1：打开命令提示符

- 在Windows搜索栏中输入"cmd"
- 右键点击"命令提示符"，选择"以管理员身份运行"

### 步骤2：安装所有必要的依赖库

在命令提示符中运行以下命令：

```
python -m pip install pandas openpyxl xlrd
```

### 如果上述命令失败，可以尝试以下替代方法：

1. **使用国内镜像源加快安装速度**
   ```
python -m pip install pandas openpyxl xlrd -i https://pypi.tuna.tsinghua.edu.cn/simple
   ```

2. **不使用管理员权限安装**
   ```
python -m pip install pandas openpyxl xlrd --user
   ```

3. **更新pip后再安装**
   ```
python -m pip install --upgrade pip
python -m pip install pandas openpyxl xlrd
   ```

## 验证安装

安装完成后，可以在命令提示符中运行以下命令来验证各库是否安装成功：

```
python -c "import pandas; print('pandas安装成功')"
python -c "import openpyxl; print('openpyxl安装成功')"
python -c "import xlrd; print('xlrd安装成功')"
```

## 步骤三：运行程序

安装完成后，您可以通过以下方法之一运行程序：

### 方法一：直接运行批处理文件

1. 在文件资源管理器中找到 `run_processor.bat` 文件
2. 双击该文件运行

### 方法二：通过命令行运行

1. 打开命令提示符
2. 使用 `cd` 命令导航到程序所在文件夹：
   ```
   cd d:\xxj\java\workspace_office
   ```
3. 输入以下命令运行程序：
   ```
   python accounting_processor.py
   ```

## 常见问题及解决方案

### 1. 找不到Python或pip命令
- 确认已正确安装Python，并已将Python添加到系统环境变量中
- 您可以从[Python官网](https://www.python.org/downloads/)下载并安装最新版本的Python（安装时勾选"Add Python to PATH"选项）

### 2. 安装过程中出现权限错误
- 确保以管理员身份运行命令提示符
- 或使用`--user`参数进行用户级安装

### 3. 安装速度慢或连接超时
- 使用国内镜像源（如清华镜像源）
- 检查网络连接是否稳定

### 4. 程序运行后没有反应或出现其他错误
- 请确保您的电脑上安装了WPS Office或Microsoft Office，并且您的输入文件符合程序要求的格式（包含"序时账"和"模板"工作表）
- 可以尝试卸载并重新安装Python
- 或参考各库的官方文档获取更详细的安装说明

## 程序使用说明

1. 程序启动后，会显示一个图形界面
2. 点击"浏览..."按钮选择要处理的WPS Office文件
3. 点击"处理文件"按钮开始处理
4. 处理完成后，结果文件将保存在源文件同一目录下，文件名格式为"原文件名_处理结果.xlsx"

如果您在使用过程中遇到任何问题，请参考程序界面中的日志信息，或重新阅读本指南。